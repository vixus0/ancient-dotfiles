#!/usr/bin/bash

favf=${FAVPROGS:-$HOME/.local/share/favprogs}
fn="xft:lemon:size=10"
n_bg="#121317"
n_fg="#a5a9b5"
s_bg="#1e2d33"
s_fg="#1e6a9a"

dm() {
  dmenu \
    -fn $fn \
    -nb $n_bg -nf $n_fg -sb $s_bg -sf $s_fg
}

# dmenu fav prog launcher
outp="$(cat $favf | dm)"
cln="${outp/!/}"
pre="${cln%%:*}"
cmd="${cln#*:}"


case $pre in
  "t")
    urxvtc -e $cmd &
    ;;
  "g")
    firefox "https://www.google.co.uk/search?q=$cmd" &
    ;;
  *)
    $cmd
    ;;
esac

# Prefixing command with ! doesn't add it to the favlist
if [[ ${outp:0:1} != '!' ]]; then
  grep "$outp" $favf &> /dev/null || echo "$outp" >> $favf
fi
